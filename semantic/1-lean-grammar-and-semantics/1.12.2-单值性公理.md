# 1.12.2 单值性公理 / Univalence Axiom

[返回目录](../CONTINUOUS_PROGRESS.md) | [上一节: 1.12.1-路径类型与等价.md](1.12.1-路径类型与等价.md)

---

## 1.12.2.1 核心定义 / Core Definition

**中文**：单值性公理（Univalence Axiom）是 HoTT 的核心公理，断言等价类型之间可以互换。它统一了类型论和拓扑学，为数学基础提供了新的视角。

**English**: The Univalence Axiom is a core axiom of HoTT, asserting that equivalent types can be identified/interchanged. It unifies type theory and topology, providing a new perspective on mathematical foundations.

### 1.12.2.1.1 数学背景 / Mathematical Background

单值性公理源于同伦论中的思想，将类型视为空间，类型等价视为同伦等价。这为数学提供了一个统一的框架，其中集合论、范畴论和拓扑学都可以在类型论中表达。

### 1.12.2.1.2 核心思想 / Core Ideas

1. **类型即空间**：每个类型对应一个拓扑空间
2. **等价即同伦**：类型等价对应同伦等价
3. **相等即等价**：类型相等蕴含类型等价
4. **单值性**：类型等价蕴含类型相等

---

## 1.12.2.2 形式化模型 / Formal Model

### 1.12.2.2.1 公理表述 / Axiom Statement

单值性公理可以形式化表述为：

$$(A \simeq B) \simeq (A = B)$$

其中 $A \simeq B$ 表示类型 $A$ 和 $B$ 等价，$A = B$ 表示类型相等。

### 1.12.2.2.2 等价类型定义 / Equivalence Definition

等价类型定义为：

$$A \simeq B := \sum_{f:A \to B} \text{isEquiv}(f)$$

其中 $\text{isEquiv}(f)$ 表示函数 $f$ 是等价。

### 1.12.2.2.3 等价函数性质 / Equivalence Properties

函数 $f : A \to B$ 是等价当且仅当：

1. **满射性**：$\forall y : B, \exists x : A, f(x) = y$
2. **单射性**：$\forall x_1, x_2 : A, f(x_1) = f(x_2) \to x_1 = x_2$
3. **同伦性**：存在逆函数 $g : B \to A$ 使得 $g \circ f \sim \text{id}_A$ 且 $f \circ g \sim \text{id}_B$

- 类型等价与等式的统一

---

## 1.12.2.3 Lean 代码示例 / Lean Code Example

### 1.12.2.3.1 等价类型定义 / Equivalence Type Definition

```lean
-- 等价类型定义
def Equiv (α β : Type) : Type :=
  Σ f : α → β, is_equiv f

-- 等价函数性质
def is_equiv {α β : Type} (f : α → β) : Prop :=
  ∃ g : β → α, (∀ x, g (f x) = x) ∧ (∀ y, f (g y) = y)

-- 等价类型构造
def equiv_mk {α β : Type} (f : α → β) (g : β → α) 
  (h1 : ∀ x, g (f x) = x) (h2 : ∀ y, f (g y) = y) : Equiv α β :=
  ⟨f, ⟨g, ⟨h1, h2⟩⟩⟩
```

### 1.12.2.3.2 单值性公理实现 / Univalence Axiom Implementation

```lean
-- 单值性公理（在 Lean 中作为公理）
axiom univalence {α β : Type} : Equiv α β ≃ (α = β)

-- 单值性公理的应用
def univalence_elim {α β : Type} (e : Equiv α β) : α = β :=
  (univalence e).1

def univalence_intro {α β : Type} (p : α = β) : Equiv α β :=
  (univalence.symm p).1
```

### 1.12.2.3.3 实际应用示例 / Practical Application Examples

```lean
-- 示例：Bool 和 Unit + Unit 的等价
def bool_to_sum : Bool → Unit ⊕ Unit
| Bool.true => Sum.inl Unit.unit
| Bool.false => Sum.inr Unit.unit

def sum_to_bool : Unit ⊕ Unit → Bool
| Sum.inl _ => Bool.true
| Sum.inr _ => Bool.false

-- 证明等价性
theorem bool_equiv_sum : Equiv Bool (Unit ⊕ Unit) :=
  equiv_mk bool_to_sum sum_to_bool
    (λ b => by cases b; simp)
    (λ s => by cases s; simp)

-- 使用单值性公理
theorem bool_eq_sum : Bool = (Unit ⊕ Unit) :=
  univalence_elim bool_equiv_sum

-- 证明等价
theorem bool_equiv_sum : Equiv Bool (Unit ⊕ Unit) := by
  exists bool_to_sum
  exists sum_to_bool
  constructor
  · intro b
    cases b <;> rfl
  · intro s
    cases s <;> rfl

-- 应用单值性公理
def bool_eq_sum : Bool = (Unit ⊕ Unit) :=
  univalence_elim bool_equiv_sum

-- 高阶等价示例
def List_equiv_Vec : Equiv (List α) (Σ n : Nat, Vec α n) :=
  equiv_mk 
    (λ xs => ⟨xs.length, list_to_vec xs⟩)
    (λ ⟨n, v⟩ => vec_to_list v)
    (λ xs => by simp)
    (λ ⟨n, v⟩ => by simp)

-- 使用单值性公理证明高阶类型等价
theorem List_eq_Vec : List α = (Σ n : Nat, Vec α n) :=
  univalence_elim List_equiv_Vec
```

---

## 1.12.2.4 理论意义与应用 / Theoretical Significance and Applications

### 1.12.2.4.1 数学基础统一 / Unification of Mathematical Foundations

单值性公理为数学提供了一个统一的框架：

- **集合论**：类型可以表示集合
- **范畴论**：类型可以表示范畴对象
- **拓扑学**：类型可以表示拓扑空间
- **代数**：类型可以表示代数结构

### 1.12.2.4.2 计算意义 / Computational Significance

- **类型安全**：保证程序类型安全
- **程序等价**：等价程序可以互换
- **优化机会**：基于等价性进行优化
- **模块化**：支持模块化程序设计

### 1.12.2.4.3 前沿研究方向 / Frontier Research Directions

- **AI辅助证明**：自动化等价性证明
- **可视化工具**：等价性可视化
- **工程应用**：在大型系统中的应用
- **教育推广**：HoTT的教学方法

## 1.12.2.5 交叉引用 / Cross References

- [1.12-同伦类型论.md](1.12-同伦类型论.md) - HoTT基础理论
- [1.12.1-路径类型与等价.md](1.12.1-路径类型与等价.md) - 路径类型基础
- [1.12.3-高阶等价与∞-范畴.md](1.12.3-高阶等价与∞-范畴.md) - 高阶结构

---

## 1.12.2.6 2025 规范对齐 / Alignment with Lean 4 (2025)

### 1.12.2.6.1 公理化引入 / Axiomatic Introduction

- **一致性影响**：清晰标注单值性公理对系统一致性的影响
- **适用范围**：明确公理的适用范围和限制
- **计算性分离**：与核心内核分离，避免影响可计算性

### 1.12.2.6.2 实现策略 / Implementation Strategy

- **扩展库**：将HoTT扩展作为独立库实现
- **接口设计**：提供清晰的公理化接口
- **文档说明**：详细说明公理的使用方法

### 1.12.2.6.3 最佳实践 / Best Practices

- **等价定理**：使用等价/传输定理的形式
- **避免误导**：不展示误导性的"可计算"示例
- **类型安全**：保证类型安全性和一致性

## 1.12.2.7 版本兼容性 / Version Compatibility

### 1.12.2.7.1 Lean版本支持 / Lean Version Support

- **Lean 4**：基础内核不内置HoTT扩展
- **扩展库**：需要安装专门的HoTT库
- **版本管理**：明确标注扩展库的版本要求

### 1.12.2.7.2 接口稳定性 / Interface Stability

- **实验性接口**：标注实验性功能的稳定性
- **公共接口**：优先使用已验证的公共接口
- **向后兼容**：保证接口的向后兼容性

## 1.12.2.8 参考资料 / References

### 1.12.2.8.1 经典文献 / Classic Literature

- **HoTT Book**：Univalence章节的详细讨论
- **Voevodsky论文**：单值性公理的原始提出
- **类型论教材**：HoTT在类型论中的地位

### 1.12.2.8.2 社区资源 / Community Resources

- **Lean/HoTT社区**：最新的发展和讨论
- **在线教程**：HoTT的学习资源
- **开源项目**：相关的开源实现

### 1.12.2.8.3 进一步阅读 / Further Reading

- **同伦论基础**：理解HoTT的数学背景
- **范畴论应用**：HoTT在范畴论中的应用
- **计算机科学应用**：HoTT在编程语言中的应用
